generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model clientes {
  ci        Int      @id
  nombre    String   @db.VarChar(100)
  email     String?  @db.VarChar(100)
  telefono  String?  @db.VarChar(20)
  direccion String?  @db.VarChar(200)
  ventas    ventas[]
}

model detalle_venta {
  id_detalle      Int       @id @default(autoincrement())
  id_venta        Int
  id_producto     Int
  cantidad        Int
  precio_unitario Decimal   @db.Decimal(10, 2)
  subtotal        Decimal   @db.Decimal(10, 2)
  ventas          ventas    @relation(fields: [id_venta], references: [id_venta], onDelete: NoAction, onUpdate: NoAction, map: "detalle_venta_ibfk_1")
  productos       productos @relation(fields: [id_producto], references: [id_producto], onDelete: NoAction, onUpdate: NoAction, map: "detalle_venta_ibfk_2")

  @@index([id_producto], map: "id_producto")
  @@index([id_venta], map: "id_venta")
}

model inventario {
  id_inventario        Int       @id @default(autoincrement())
  id_producto          Int
  stock_actual         Int?      @default(0)
  stock_minimo         Int?      @default(5)
  ultima_actualizacion DateTime @default(now()) @updatedAt @db.Timestamp(0)
  productos            productos @relation(fields: [id_producto], references: [id_producto], onDelete: NoAction, onUpdate: NoAction, map: "inventario_ibfk_1")

  @@index([id_producto], map: "id_producto")
}

model productos {
  id_producto   Int             @id @default(autoincrement())
  codigo_sku    String?         @unique(map: "codigo_sku") @db.VarChar(50)
  marca         String          @db.VarChar(50)
  modelo        String          @db.VarChar(100)
  categoria     String?         @db.VarChar(50)
  color         String?         @db.VarChar(40)
  medida        String          @db.VarChar(20)
  precio_actual Decimal         @db.Decimal(10, 2)
  descripcion   String?         @db.Text
  imagen        String?         @db.VarChar(255)
  detalle_venta detalle_venta[]
  inventario    inventario[]
}

model ventas {
  id_venta      Int             @id @default(autoincrement())
  ci            Int?
  fecha_venta   DateTime?       @default(now()) @db.Timestamp(0)
  total         Decimal?        @db.Decimal(10, 2)
  metodo_pago   String?         @db.VarChar(50)
  detalle_venta detalle_venta[]
  clientes      clientes?       @relation(fields: [ci], references: [ci], onDelete: NoAction, onUpdate: NoAction, map: "ventas_ibfk_1")

  @@index([ci], map: "ci")
}
